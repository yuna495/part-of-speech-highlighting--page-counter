# 日本語 品詞カラー表示＋ページカウンタ

**日本語テキスト向け**の VS Code 拡張です。（最新版: v1.3.6）

- 品詞ごとの色分け（semantic token）
- 括弧・記号・全角スペースの強調表示
- 括弧内ハイライトの ON/OFF 切り替え
- ページカウンタ（原稿用紙風、行頭禁則あり）
- ステータスバーで文字数・コミット差分を表示
- 見出しビュー／ミニマップ強調／折りたたみ制御
- 全角括弧の入力支援（自動補完・Backspace連動）
- `.txt` / `.md` / `Novel` に対応
  
---

## デモ

![Demo Screenshot](https://raw.githubusercontent.com/yuna495/part-of-speech-highlighting--page-counter/master/demo/demo.png)

例：小説テキストに品詞ごとの色付け・括弧と記号の強調・ページ数と文字数カウント・見出し例を表示

---

## 主な機能

### ハイライト

- **品詞カラー表示**  
  - `kuromoji` による形態素解析で、名詞 / 動詞 / 形容詞 / 副詞 / 助詞 / 助動詞 / 連体詞 / 接続詞 / 感動詞 / 接頭詞 / その他を色分け
- **括弧・記号ハイライト**  
  - 全角括弧とその中身を `bracket` として強調（改行またぎ・ネスト対応）
  - 「—」「、」「。」などの記号も専用色で表示
- **括弧内ハイライトのトグル（v1.3.5）**  
  - `posNote.semantic.bracketsOverride.enabled`  
  - ON（既定）: 括弧と括弧内を専用色で塗り、括弧内は品詞ハイライトを抑制  
  - OFF: 括弧内も通常どおり品詞ハイライトを適用
- **全角スペース表示**  
  - semantic token による下線表示（テーマと干渉しにくい）

### プレビュー（v2.0.0）

- エディタ右上の 📖 アイコンで縦書きプレビューを開く
- エディタで選択した行がプレビュー側でハイライトされ、プレビューで行をクリックするとエディタが同期する
- プレビュー内にも品詞ハイライトを適用可能
- 反映タイミングはエディタ保存時
- 品詞ハイライトは「選択行 ±maxLines 行」（既定: 2000 行）を対象に動的に解析する

### 見出し機能

- **折りたたみ制御（v1.3.0）**  
  - 「#」で第一見出し、「##」で第二見出し  
  - `Ctrl + [` で展開／折りたたみをトグル  
  - 最小レベルを設定可能：`posNote.headings.foldMinLevel`（既定 2）
- **見出しビュー（v1.3.3）**  
  - サイドバーに見出しを一覧表示、クリックでジャンプ
- **ミニマップ強調（v1.3.4）**  
  - ミニマップ上に見出しレベルごとの色付きバーを表示

### ステータスバー

- **ページカウンタ**  
  - 原稿用紙風（行×列）で折り返し、行頭禁則処理に対応
  - 多少の誤差が生じているかもしれないので、あくまで参考程度にご活用下さい。
- **文字数表示**  
  - 選択範囲があればその文字数、なければ全体文字数  
  - 見出し行（# / ##）はカウントから除外（v1.3.2）  
  - スペースを含めるかどうか設定可能
- **差分表示**  
  - HEAD（直近コミット）との差分を ± で表示
- **合算文字数（v1.2.0）**  
  - 同じフォルダ・同じ拡張子ファイルを合算し表示（設定で ON/OFF）

### 入力支援

- **全角括弧の入力補完**  
  - 「『（［｛〈《【〔」などの開きを入力すると自動で閉じを補完
  - ネスト対応：`「『』」` のように正しく保持
  - IME 変換追従／Backspace 連動にも対応

---

## 設定

主な設定項目：

| 設定キー | 説明 | 既定値 |
|----------|------|--------|
| `posNote.semantic.enabled` | `.txt` / `Novel` の品詞ハイライト有効化 | `true` |
| `posNote.semantic.enabledMd` | `.md` の品詞ハイライト有効化 | `true` |
| `posNote.semantic.bracketsOverride.enabled` | 括弧内を専用色にするか（ON: 専用色＋品詞抑制 / OFF: 品詞適用） | `true` |
| `posNote.kinsoku.bannedStart` | 行頭禁則文字リスト | デフォルトあり |
| `posNote.headings.foldMinLevel` | 折りたたみの最小レベル（2=##以上） | `2` |

### 設定例

```jsonc
{
  // エディタとプレビューどちらも共通色
  "editor.semanticTokenColorCustomizations": {
    "rules": {
      // 品詞ごとの例（任意で色コードを変更可能）
      "noun": "#4dd0e1",        // 名詞
      "verb": "#11ff84",        // 動詞
      "adjective": "#ffd900",   // 形容詞
      "adverb": "#f94446",      // 副詞
      "particle": "#f6f7f8",    // 助詞
      "auxiliary": "#a1887f",   // 助動詞
      "prenoun": "#e0a000",     // 連体詞
      "conjunction": "#ff14e0", // 接続詞
      "interjection": "#ff7043",// 感動詞
      "symbol": "#fd9bcc",      // 記号
      "other": "#9e9e9e",       // その他

      // 特殊トークン
      "bracket": "#fd9bcc",     // 括弧と括弧内文書
      "fwspace": {                // 全角スペース
        "underline": true,
        "foreground": "#ff0000"
      },
      "heading": "#ff14e0"      // 見出しカラー
    }
  },
  "posNote.semantic.enabled": true,
  "posNote.semantic.enabledMd": true,
  "posNote.semantic.bracketsOverride.enabled": true,
  "posNote.headings.foldMinLevel": 2,
  "posNote.kinsoku.bannedStart": [
    "」","）","『","』","》","】","。","、",
    "’","”","！","？","…","—","―"
  ]
}
```


## 推奨ワークフロー

- `.txt` `.md` での小説や論文執筆
- 入力中はカーソル周辺のみ色付け → 軽快に作業
- 仕上げ時に全装飾を適用 → 読みやすさ向上

## 既知の制約

- 大規模ファイルでは解析負荷が高くなる可能性あり
- 禁則処理は一部の組み合わせに限定


## ライセンス

MIT
